<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>치매안심센터 지도</title>
  <style>
    #map {
      width: 100%;
      height: 600px;
    }
  </style>
  <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=b08bb0d7029cff05ee0ab4ab533493ce"></script>
</head>
<body>
  <h1>전국 치매안심센터 지도</h1>
  <div id="map"></div>

  <script>
    const serviceKey = 'PGaRDR11RPT4oGwm0d1zVinIrqETQaNooSxuLuV5C56uqGE%2Bcdg1Scr5ZMaWaGcNAXG1v9K1JYgpU8z3SzZoOQ%3D%3D';
    const url = `https://api.data.go.kr/openapi/tn_pubr_public_imbclty_cnter_api?serviceKey=${serviceKey}&pageNo=1&numOfRows=100&type=json`;

    // 지도 초기화
    const mapContainer = document.getElementById('map');
    const mapOption = {
      center: new kakao.maps.LatLng(36.5, 127.8), // 대한민국 중심 좌표
      level: 13
    };
    const map = new kakao.maps.Map(mapContainer, mapOption);

    fetch(url)
      .then(response => response.json())
      .then(data => {
        const items = data.response.body.items.item;
        items.forEach(center => {
          const name = center.cnterNm;
          const address = center.rdnmadr;
          const phone = center.operPhoneNumber;
          const lat = parseFloat(center.latitude);
          const lng = parseFloat(center.longitude);

          // 마커 생성
          const marker = new kakao.maps.Marker({
            map: map,
            position: new kakao.maps.LatLng(lat, lng)
          });

          // 마커 정보창
          const infoContent = `
            <div style="padding:8px;">
              <strong>${name}</strong><br>
              ${address}<br>
              ${phone}
            </div>
          `;
          const infowindow = new kakao.maps.InfoWindow({
            content: infoContent
          });

          // 마커 클릭 시 정보창 열기
          kakao.maps.event.addListener(marker, 'click', function() {
            infowindow.open(map, marker);
          });
        });
      })
      .catch(err => console.error('API 호출 오류:', err));
  </script>
</body>
</html>

